{"version":3,"sources":["slidem-deck.js"],"names":["GluonElement","html","onRouteChange","currentPath","currentHash","styleText","document","createTextNode","styleNode","createElement","appendChild","head","SlidemDeck","template","connectedCallback","slides","Array","from","getElementsByTagName","forEach","$","progress","currentSlide","step","currentStep","active","classList","add","previousSlide","remove","fadeOutSlide","children","forward","onclick","reveals","length","window","history","pushState","dispatchEvent","Event","backward","removeAttribute","getAttribute","style","fontFamily","FontFaceObserver","load","then","match","customElements","define","is"],"mappings":"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","file":"slidem-deck.js","sourcesContent":["import { GluonElement, html } from '../gluonjs/gluon.js';\nimport { onRouteChange, currentPath, currentHash } from '../gluon-router/gluon-router.js';\nimport './slidem-slide.js';\n\nimport '../fontfaceobserver/fontfaceobserver.standalone.js';\nimport '../gluon-keybinding/gluon-keybinding.js';\n\nconst styleText = document.createTextNode(`\n  /* SLIDEM SHARED STYLE */\n  body {\n    margin: 0;\n  }\n\n  slidem-deck slidem-slide h1,\n  slidem-deck slidem-slide h2,\n  slidem-deck slidem-slide h3,\n  slidem-deck slidem-slide h4,\n  slidem-deck slidem-slide h5,\n  slidem-deck slidem-slide h6,\n  slidem-deck slidem-slide p {\n    margin-top: 0px;\n    margin-bottom: 0px;\n  }\n\n  /* Avoid overflow which breaks width calculation */\n  slidem-deck slidem-slide [fit] {\n    font-size: 30px;\n  }\n\n  slidem-deck slidem-slide a {\n    color: inherit;\n    text-decoration: none;\n  }\n\n  [reveal] {\n    transition: opacity 0.2s;\n  }\n`);\n\nconst styleNode = document.createElement('style');\nstyleNode.appendChild(styleText);\ndocument.head.appendChild(styleNode);\n\nclass SlidemDeck extends GluonElement {\n  get template() {\n    return html`\n      <div class=\"slides\">\n        <slot id=\"slides\"></slot>\n      </div>\n      <div id=\"progress\"></div>\n      <div id=\"forward\">\n        <gluon-keybinding key=\"ArrowRight\"></gluon-keybinding>\n      </div>\n      <div id=\"backward\">\n        <gluon-keybinding key=\"ArrowLeft\"></gluon-keybinding>\n      </div>\n      <style>\n        :host {\n          display: block;\n          overflow: hidden;\n          position: absolute;\n          top: 0;\n          left: 0;\n          bottom: 0;\n          right: 0;\n          font-family: 'sans-serif';\n          font-size: 56px;\n          line-height: 1;\n        }\n        .slides {\n          height: 100%;\n          width: 100%;\n        }\n        #progress {\n          position: absolute;\n          bottom: 0px;\n          left: 0;\n          right: 0;\n          height: 50px;\n          text-align: center;\n          display: flex;\n          flex-flow: row;\n          justify-content: center;\n          z-index: 10;\n        }\n        #progress div {\n          height: 8px;\n          width: 8px;\n          border-radius: 50%;\n          border: 2px solid white;\n          margin-left: 6px;\n          margin-right: 6px;\n          background: transparent;\n          transition: background 0.2s;\n        }\n        #progress div.active {\n          background: white;\n        }\n      </style>\n    `;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.slides = Array.from(this.getElementsByTagName('slidem-slide'));\n    this.slides.forEach(slide => {\n      this.$.progress.appendChild(document.createElement('div'));\n    });\n\n    onRouteChange(() => {\n      this.slides[this.currentSlide].step = this.currentStep + 1;\n      this.slides[this.currentSlide].active = true;\n      this.slides[this.currentSlide].classList.add('animate-in');\n\n      if (this.previousSlide === this.currentSlide) {\n        return;\n      }\n      if (this.previousSlide !== undefined) {\n        if (this.previousSlide < this.currentSlide) {\n          this.slides[this.previousSlide].classList.add('animate-forward');\n          this.slides[this.currentSlide].classList.add('animate-forward');\n          this.slides[this.previousSlide].classList.remove('animate-backward');\n          this.slides[this.currentSlide].classList.remove('animate-backward');\n        } else {\n          this.slides[this.previousSlide].classList.add('animate-backward');\n          this.slides[this.currentSlide].classList.add('animate-backward');\n          this.slides[this.previousSlide].classList.remove('animate-forward');\n          this.slides[this.currentSlide].classList.remove('animate-forward');\n        }\n      }\n      if (this.fadeOutSlide !== undefined) {\n        this.slides[this.fadeOutSlide].classList.remove('animate-out');\n        if (this.fadeOutSlide !== this.currentSlide) {\n          this.slides[this.fadeOutSlide].active = false;\n        }\n      }\n\n      if (this.previousSlide !== undefined) {\n        this.slides[this.previousSlide].classList.remove('animate-in');\n        this.slides[this.previousSlide].classList.add('animate-out');\n        this.$.progress.children[this.previousSlide].classList.remove('active');\n        this.fadeOutSlide = this.previousSlide;\n      }\n\n      this.$.progress.children[this.currentSlide].classList.add('active');\n\n      this.previousSlide = this.currentSlide;\n    });\n\n    this.$.forward.onclick = () => {\n      if (this.slides[this.currentSlide].step <= this.slides[this.currentSlide].reveals.length) {\n        window.history.pushState({}, '', `${currentPath()}#slide-${this.currentSlide + 1}/step-${this.slides[this.currentSlide].step + 1}`);\n        window.dispatchEvent(new Event('location-changed'));\n      } else if (this.currentSlide < this.slides.length - 1) {\n        window.history.pushState({}, '', `${currentPath()}#slide-${this.currentSlide + 2}/step-1`);\n        window.dispatchEvent(new Event('location-changed'));\n      }\n    };\n\n    this.$.backward.onclick = () => {\n      if (this.slides[this.currentSlide].step > 1) {\n        window.history.pushState({}, '', `${currentPath()}#slide-${this.currentSlide + 1}/step-${this.slides[this.currentSlide].step - 1}`);\n        window.dispatchEvent(new Event('location-changed'));\n      } else if (this.currentSlide > 0) {\n        window.history.pushState({}, '', `${currentPath()}#slide-${this.currentSlide}/step-${this.slides[this.currentSlide - 1].reveals.length + 1}`);\n        window.dispatchEvent(new Event('location-changed'));\n      }\n    };\n\n    this.removeAttribute('loading');\n\n    const init = () => {\n      window.dispatchEvent(new Event('location-changed'));\n    };\n\n    const font = this.getAttribute('font');\n    if (font) {\n      this.style.fontFamily = font;\n      new FontFaceObserver(font).load().then(init, init);\n    } else {\n      init();\n    }\n  }\n\n  get currentSlide() {\n    return (currentHash().match(/(?:slide-(\\d+))?(?:\\/step-(\\d+|Infinity))?/)[1] || 1) - 1;\n  }\n  get currentStep() {\n    return (currentHash().match(/(?:slide-(\\d+))?(?:\\/step-(\\d+|Infinity))?/)[2] || 1) - 1;\n  }\n}\n\ncustomElements.define(SlidemDeck.is, SlidemDeck);\n"]}